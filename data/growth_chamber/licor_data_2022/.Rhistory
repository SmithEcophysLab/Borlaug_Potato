#                                   fit_aci_id86_post$Km,
#                                   fit_aci_id86_post$GammaStar,
#                                   fit_aci_id86_post$fitmethod,
#                                   fit_aci_id86_post$Tcorrect,
#                                   fit_aci_id86_post$fitTPU)
# colnames(aci_data_id86_post_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
#                                         'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
#                                         'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
#                                         'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
#                                         'aci_km', 'aci_gammastar', 'aci_fitmethod',
#                                         'aci_tcorrect', 'aci_fittpu')
# curve_fits <- rbind(curve_fits, aci_data_id86_post_data)
##############################################################################
##############################################################################
###########id88
##############################################################################
##############################################################################
### plant id88 pre_heatwave
# aci_data_id88_pre = subset(aci_data, id == ids[86] & meas.type == 'pre_heatwave')
# aci_data_id88_pre[, c(6,9:10)]
# #### plot raw data and remove values if needed
# plot(Adyn ~ Ci, data = aci_data_id88_pre)
# #### fit aci curve
# fit_aci_id88_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
#                            # citransition = 300,
#                            Tcorrect = FALSE,
#                            fitTPU = FALSE,
#                            fitmethod = 'bilinear',
#                            data = aci_data_id88_pre)
# summary(fit_aci_id88_pre)
# #### plot
# plot(fit_aci_id88_pre)
# #### add to dataframe
# aci_data_id88_pre_data <- cbind(aci_data_id88_pre[1, c(10, 284, 9, 14, 16, 19)],
#                                  mean(aci_data_id88_pre[,30]),
#                                  mean(aci_data_id88_pre[,118]),
#                                  fit_aci_id88_pre[[2]][1,1],
#                                  fit_aci_id88_pre[[2]][1,2],
#                                  fit_aci_id88_pre[[2]][2,1],
#                                  fit_aci_id88_pre[[2]][2,2],
#                                  fit_aci_id88_pre[[2]][3,1],
#                                  fit_aci_id88_pre[[2]][3,2],
#                                  # fit_aci_id88_pre[[2]][4,1],
#                                  # fit_aci_id88_pre[[2]][4,2],
#                                  fit_aci_id88_pre$RMSE,
#                                  fit_aci_id88_pre$Ci_transition,
#                                  fit_aci_id88_pre$citransition,
#                                  fit_aci_id88_pre$Km,
#                                  fit_aci_id88_pre$GammaStar,
#                                  fit_aci_id88_pre$fitmethod,
#                                  fit_aci_id88_pre$Tcorrect,
#                                  fit_aci_id88_pre$fitTPU)
# colnames(aci_data_id88_pre_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
#                                        'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
#                                        'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
#                                        'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
#                                        'aci_km', 'aci_gammastar', 'aci_fitmethod',
#                                        'aci_tcorrect', 'aci_fittpu')
# curve_fits <- rbind(curve_fits, aci_data_id88_pre_data)
#
# ### plant id88 post_heatwave
# aci_data_id88_post = subset(aci_data, id == ids[86] & meas.type == 'post_heatwave')
# aci_data_id88_post[, c(6,9:10)]
# #### plot raw data and remove values if needed
# plot(Adyn ~ Ci, data = aci_data_id88_post)
# #### fit aci curve
# fit_aci_id88_post = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
#                             # citransition = 300,
#                             Tcorrect = FALSE,
#                             fitTPU = FALSE,
#                             fitmethod = 'bilinear',
#                             data = aci_data_id88_post)
# summary(fit_aci_id88_post)
# #### plot
# plot(fit_aci_id88_post)
# #### add to dataframe
# aci_data_id88_post_data <- cbind(aci_data_id88_post[1, c(10, 284, 9, 14, 16, 19)],
#                                   mean(aci_data_id88_post[,30]),
#                                   mean(aci_data_id88_post[,118]),
#                                   fit_aci_id88_post[[2]][1,1],
#                                   fit_aci_id88_post[[2]][1,2],
#                                   fit_aci_id88_post[[2]][2,1],
#                                   fit_aci_id88_post[[2]][2,2],
#                                   fit_aci_id88_post[[2]][3,1],
#                                   fit_aci_id88_post[[2]][3,2],
#                                   # fit_aci_id88_post[[2]][4,1],
#                                   # fit_aci_id88_post[[2]][4,2],
#                                   fit_aci_id88_post$RMSE,
#                                   fit_aci_id88_post$Ci_transition,
#                                   fit_aci_id88_post$citransition,
#                                   fit_aci_id88_post$Km,
#                                   fit_aci_id88_post$GammaStar,
#                                   fit_aci_id88_post$fitmethod,
#                                   fit_aci_id88_post$Tcorrect,
#                                   fit_aci_id88_post$fitTPU)
# colnames(aci_data_id88_post_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
#                                         'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
#                                         'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
#                                         'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
#                                         'aci_km', 'aci_gammastar', 'aci_fitmethod',
#                                         'aci_tcorrect', 'aci_fittpu')
# curve_fits <- rbind(curve_fits, aci_data_id88_post_data)
##############################################################################
##############################################################################
###########id9
##############################################################################
##############################################################################
### plant id9 pre_heatwave
aci_data_id9_pre = subset(aci_data, id == ids[87] & meas.type == 'pre_heatwave' & Ci < 900)
aci_data_id9_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id9_pre)
#### fit aci curve
fit_aci_id9_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 300,
Tcorrect = FALSE,
fitTPU = FALSE,
fitmethod = 'bilinear',
data = aci_data_id9_pre)
summary(fit_aci_id9_pre)
#### plot
plot(fit_aci_id9_pre)
#### add to dataframe
aci_data_id9_pre_data <- cbind(aci_data_id9_pre[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id9_pre[,30]),
mean(aci_data_id9_pre[,118]),
fit_aci_id9_pre[[2]][1,1],
fit_aci_id9_pre[[2]][1,2],
fit_aci_id9_pre[[2]][2,1],
fit_aci_id9_pre[[2]][2,2],
fit_aci_id9_pre[[2]][3,1],
fit_aci_id9_pre[[2]][3,2],
# fit_aci_id9_pre[[2]][4,1],
# fit_aci_id9_pre[[2]][4,2],
fit_aci_id9_pre$RMSE,
fit_aci_id9_pre$Ci_transition,
fit_aci_id9_pre$citransition,
fit_aci_id9_pre$Km,
fit_aci_id9_pre$GammaStar,
fit_aci_id9_pre$fitmethod,
fit_aci_id9_pre$Tcorrect,
fit_aci_id9_pre$fitTPU)
colnames(aci_data_id9_pre_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
'aci_km', 'aci_gammastar', 'aci_fitmethod',
'aci_tcorrect', 'aci_fittpu')
curve_fits <- rbind(curve_fits, aci_data_id9_pre_data)
### plant id9 post_heatwave
aci_data_id9_post = subset(aci_data, id == ids[87] & meas.type == 'post_heatwave')
aci_data_id9_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id9_post)
#### fit aci curve
fit_aci_id9_post = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 300,
Tcorrect = FALSE,
fitTPU = FALSE,
fitmethod = 'bilinear',
data = aci_data_id9_post)
summary(fit_aci_id9_post)
#### plot
plot(fit_aci_id9_post)
#### add to dataframe
aci_data_id9_post_data <- cbind(aci_data_id9_post[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id9_post[,30]),
mean(aci_data_id9_post[,118]),
fit_aci_id9_post[[2]][1,1],
fit_aci_id9_post[[2]][1,2],
fit_aci_id9_post[[2]][2,1],
fit_aci_id9_post[[2]][2,2],
fit_aci_id9_post[[2]][3,1],
fit_aci_id9_post[[2]][3,2],
# fit_aci_id9_post[[2]][4,1],
# fit_aci_id9_post[[2]][4,2],
fit_aci_id9_post$RMSE,
fit_aci_id9_post$Ci_transition,
fit_aci_id9_post$citransition,
fit_aci_id9_post$Km,
fit_aci_id9_post$GammaStar,
fit_aci_id9_post$fitmethod,
fit_aci_id9_post$Tcorrect,
fit_aci_id9_post$fitTPU)
colnames(aci_data_id9_post_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
'aci_km', 'aci_gammastar', 'aci_fitmethod',
'aci_tcorrect', 'aci_fittpu')
curve_fits <- rbind(curve_fits, aci_data_id9_post_data)
##############################################################################
##############################################################################
###########id92
##############################################################################
##############################################################################
### plant id92 pre_heatwave
aci_data_id92_pre = subset(aci_data, id == ids[88] & meas.type == 'pre_heatwave')
aci_data_id92_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id92_pre)
#### fit aci curve
fit_aci_id92_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 300,
Tcorrect = FALSE,
fitTPU = FALSE,
fitmethod = 'bilinear',
data = aci_data_id92_pre)
summary(fit_aci_id92_pre)
#### plot
plot(fit_aci_id92_pre)
#### add to dataframe
aci_data_id92_pre_data <- cbind(aci_data_id92_pre[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id92_pre[,30]),
mean(aci_data_id92_pre[,118]),
fit_aci_id92_pre[[2]][1,1],
fit_aci_id92_pre[[2]][1,2],
fit_aci_id92_pre[[2]][2,1],
fit_aci_id92_pre[[2]][2,2],
fit_aci_id92_pre[[2]][3,1],
fit_aci_id92_pre[[2]][3,2],
# fit_aci_id92_pre[[2]][4,1],
# fit_aci_id92_pre[[2]][4,2],
fit_aci_id92_pre$RMSE,
fit_aci_id92_pre$Ci_transition,
fit_aci_id92_pre$citransition,
fit_aci_id92_pre$Km,
fit_aci_id92_pre$GammaStar,
fit_aci_id92_pre$fitmethod,
fit_aci_id92_pre$Tcorrect,
fit_aci_id92_pre$fitTPU)
colnames(aci_data_id92_pre_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
'aci_km', 'aci_gammastar', 'aci_fitmethod',
'aci_tcorrect', 'aci_fittpu')
curve_fits <- rbind(curve_fits, aci_data_id92_pre_data)
### plant id92 post_heatwave
aci_data_id92_post = subset(aci_data, id == ids[88] & meas.type == 'post_heatwave')
aci_data_id92_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id92_post)
#### fit aci curve
fit_aci_id92_post = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 300,
Tcorrect = FALSE,
fitTPU = FALSE,
fitmethod = 'bilinear',
data = aci_data_id92_post)
summary(fit_aci_id92_post)
#### plot
plot(fit_aci_id92_post)
#### add to dataframe
aci_data_id92_post_data <- cbind(aci_data_id92_post[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id92_post[,30]),
mean(aci_data_id92_post[,118]),
fit_aci_id92_post[[2]][1,1],
fit_aci_id92_post[[2]][1,2],
fit_aci_id92_post[[2]][2,1],
fit_aci_id92_post[[2]][2,2],
fit_aci_id92_post[[2]][3,1],
fit_aci_id92_post[[2]][3,2],
# fit_aci_id92_post[[2]][4,1],
# fit_aci_id92_post[[2]][4,2],
fit_aci_id92_post$RMSE,
fit_aci_id92_post$Ci_transition,
fit_aci_id92_post$citransition,
fit_aci_id92_post$Km,
fit_aci_id92_post$GammaStar,
fit_aci_id92_post$fitmethod,
fit_aci_id92_post$Tcorrect,
fit_aci_id92_post$fitTPU)
colnames(aci_data_id92_post_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
'aci_km', 'aci_gammastar', 'aci_fitmethod',
'aci_tcorrect', 'aci_fittpu')
curve_fits <- rbind(curve_fits, aci_data_id92_post_data)
##############################################################################
##############################################################################
###########id94
##############################################################################
##############################################################################
### plant id94 pre_heatwave
aci_data_id94_pre = subset(aci_data, id == ids[89] & meas.type == 'pre_heatwave')
aci_data_id94_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id94_pre)
#### fit aci curve
fit_aci_id94_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 300,
Tcorrect = FALSE,
fitTPU = FALSE,
fitmethod = 'bilinear',
data = aci_data_id94_pre)
summary(fit_aci_id94_pre)
#### plot
plot(fit_aci_id94_pre)
#### add to dataframe
aci_data_id94_pre_data <- cbind(aci_data_id94_pre[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id94_pre[,30]),
mean(aci_data_id94_pre[,118]),
fit_aci_id94_pre[[2]][1,1],
fit_aci_id94_pre[[2]][1,2],
fit_aci_id94_pre[[2]][2,1],
fit_aci_id94_pre[[2]][2,2],
fit_aci_id94_pre[[2]][3,1],
fit_aci_id94_pre[[2]][3,2],
# fit_aci_id94_pre[[2]][4,1],
# fit_aci_id94_pre[[2]][4,2],
fit_aci_id94_pre$RMSE,
fit_aci_id94_pre$Ci_transition,
fit_aci_id94_pre$citransition,
fit_aci_id94_pre$Km,
fit_aci_id94_pre$GammaStar,
fit_aci_id94_pre$fitmethod,
fit_aci_id94_pre$Tcorrect,
fit_aci_id94_pre$fitTPU)
colnames(aci_data_id94_pre_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
'aci_km', 'aci_gammastar', 'aci_fitmethod',
'aci_tcorrect', 'aci_fittpu')
curve_fits <- rbind(curve_fits, aci_data_id94_pre_data)
### plant id94 post_heatwave
aci_data_id94_post = subset(aci_data, id == ids[89] & meas.type == 'post_heatwave')
aci_data_id94_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id94_post)
#### fit aci curve
fit_aci_id94_post = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 300,
Tcorrect = FALSE,
fitTPU = FALSE,
fitmethod = 'bilinear',
data = aci_data_id94_post)
summary(fit_aci_id94_post)
#### plot
plot(fit_aci_id94_post)
#### add to dataframe
aci_data_id94_post_data <- cbind(aci_data_id94_post[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id94_post[,30]),
mean(aci_data_id94_post[,118]),
fit_aci_id94_post[[2]][1,1],
fit_aci_id94_post[[2]][1,2],
fit_aci_id94_post[[2]][2,1],
fit_aci_id94_post[[2]][2,2],
fit_aci_id94_post[[2]][3,1],
fit_aci_id94_post[[2]][3,2],
# fit_aci_id94_post[[2]][4,1],
# fit_aci_id94_post[[2]][4,2],
fit_aci_id94_post$RMSE,
fit_aci_id94_post$Ci_transition,
fit_aci_id94_post$citransition,
fit_aci_id94_post$Km,
fit_aci_id94_post$GammaStar,
fit_aci_id94_post$fitmethod,
fit_aci_id94_post$Tcorrect,
fit_aci_id94_post$fitTPU)
colnames(aci_data_id94_post_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
'aci_km', 'aci_gammastar', 'aci_fitmethod',
'aci_tcorrect', 'aci_fittpu')
curve_fits <- rbind(curve_fits, aci_data_id94_post_data)
nrow(curve_fits)
write.csv(curve_fits, 'aci_fits/aci_fits.csv')
library(plantecophys)
library(R.utils)
## load functions
sourceDirectory('functions')
## load data
aci_data <- read.csv('Dinah_potato_curves_fullyMerged.csv')
head(aci_data)
colnames(aci_data)
## start visualization, curve fitting, and data frame creation
ids <- levels(as.factor(aci_data$id))
curve_fits <- c()
### plant id1 pre_heatwave
aci_data_id1_pre = subset(aci_data, id == ids[1] & meas.type == 'pre_heatwave')
aci_data_id1_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id1_pre)
#### fit aci curve
fit_aci_id1_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 300,
useRd = FALSE,
Tcorrect = FALSE,
# fitTPU = FALSE,
fitmethod = 'bilinear',
data = aci_data_id1_pre)
summary(fit_aci_id1_pre)
coef_id1_pre <- coef(fit_aci_id1_pre)
#### plot
plot(fit_aci_id1_pre)
aci_data_id1_pre[1, c(10, 284, 9, 14, 16, 19)]
mean(aci_data_id1_pre[,30])
mean(aci_data_id1_pre[,118])
fit_aci_id1_pre[[2]][1,1]
#### add to dataframe
aci_data_id1_pre_data <- cbind(aci_data_id1_pre[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id1_pre[,30]),
mean(aci_data_id1_pre[,118]),
fit_aci_id1_pre[[2]][1,1],
fit_aci_id1_pre[[2]][1,2],
fit_aci_id1_pre[[2]][2,1],
fit_aci_id1_pre[[2]][2,2],
fit_aci_id1_pre[[2]][3,1],
fit_aci_id1_pre[[2]][3,2],
# fit_aci_id1_pre[[2]][4,1],
# fit_aci_id1_pre[[2]][4,2],
fit_aci_id1_pre$RMSE,
fit_aci_id1_pre$Ci_transition,
fit_aci_id1_pre$citransition,
fit_aci_id1_pre$Km,
fit_aci_id1_pre$GammaStar,
fit_aci_id1_pre$fitmethod,
fit_aci_id1_pre$Tcorrect,
fit_aci_id1_pre$fitTPU)
aci_data_id1_pre_data
colnames(aci_data_id1_pre_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
'aci_km', 'aci_gammastar', 'aci_fitmethod',
'aci_tcorrect', 'aci_fittpu')
aci_data_id1_pre_data
curve_fits <- rbind(curve_fits, aci_data_id1_pre_data)
curve_fits
### plant id1 post_heatwave
aci_data_id1_post = subset(aci_data, id == ids[1] & meas.type == 'post_heatwave')
aci_data_id1_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id1_post)
aci_data_id1_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id1_post)
#### fit aci curve
fit_aci_id1_post = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 350,
Tcorrect = FALSE,
fitTPU = FALSE,
fitmethod = 'bilinear',
data = aci_data_id1_post)
summary(fit_aci_id1_post)
coef_id1_post <- coef(fit_aci_id1_post)
#### plot
plot(fit_aci_id1_post)
##############################################################################
##############################################################################
###########id102
##############################################################################
##############################################################################
### plant id102 pre_heatwave
aci_data_id102_pre = subset(aci_data, id == ids[4] & meas.type == 'pre_heatwave' & Ci < 700)
aci_data_id102_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id102_pre)
##############################################################################
##############################################################################
###########id102
##############################################################################
##############################################################################
### plant id102 pre_heatwave
aci_data_id102_pre = subset(aci_data, id == ids[4] & meas.type == 'pre_heatwave')
aci_data_id102_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id102_pre)
##############################################################################
##############################################################################
###########id102
##############################################################################
##############################################################################
### plant id102 pre_heatwave
aci_data_id102_pre = subset(aci_data, id == ids[4] & meas.type == 'pre_heatwave' & Ci < 700)
aci_data_id102_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id102_pre)
#### fit aci curve
fit_aci_id102_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 300,
Tcorrect = FALSE,
fitTPU = FALSE,
fitmethod = 'bilinear',
data = aci_data_id102_pre)
summary(fit_aci_id102_pre)
#### plot
plot(fit_aci_id102_pre)
#### add to dataframe
aci_data_id102_pre_data <- cbind(aci_data_id102_pre[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id102_pre[,30]),
mean(aci_data_id102_pre[,118]),
fit_aci_id102_pre[[2]][1,1],
fit_aci_id102_pre[[2]][1,2],
fit_aci_id102_pre[[2]][2,1],
fit_aci_id102_pre[[2]][2,2],
fit_aci_id102_pre[[2]][3,1],
fit_aci_id102_pre[[2]][3,2],
# fit_aci_id102_pre[[2]][4,1],
# fit_aci_id102_pre[[2]][4,2],
fit_aci_id102_pre$RMSE,
fit_aci_id102_pre$Ci_transition,
fit_aci_id102_pre$citransition,
fit_aci_id102_pre$Km,
fit_aci_id102_pre$GammaStar,
fit_aci_id102_pre$fitmethod,
fit_aci_id102_pre$Tcorrect,
fit_aci_id102_pre$fitTPU)
