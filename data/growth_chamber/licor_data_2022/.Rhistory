'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
'aci_km', 'aci_gammastar', 'aci_fitmethod',
'aci_tcorrect', 'aci_fittpu')
curve_fits <- rbind(curve_fits, aci_data_id118_post_data)
curve_fits
ids[14]
##############################################################################
##############################################################################
###########id121
##############################################################################
##############################################################################
### plant id121 pre_heatwave
aci_data_id121_pre = subset(aci_data, id == ids[14] & meas.type == 'pre_heatwave')
aci_data_id121_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id121_pre)
#### fit aci curve
fit_aci_id121_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
citransition = 350,
Tcorrect = FALSE,
data = aci_data_id121_pre)
summary(fit_aci_id121_pre)
#### plot
plot(fit_aci_id121_pre)
#### add to dataframe
aci_data_id121_pre_data <- cbind(aci_data_id121_pre[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id121_pre[,30]),
mean(aci_data_id121_pre[,118]),
fit_aci_id121_pre[[2]][1,1],
fit_aci_id121_pre[[2]][1,2],
fit_aci_id121_pre[[2]][2,1],
fit_aci_id121_pre[[2]][2,2],
fit_aci_id121_pre[[2]][3,1],
fit_aci_id121_pre[[2]][3,2],
fit_aci_id121_pre$RMSE,
fit_aci_id121_pre$Ci_transition,
fit_aci_id121_pre$citransition,
fit_aci_id121_pre$Km,
fit_aci_id121_pre$GammaStar,
fit_aci_id121_pre$fitmethod,
fit_aci_id121_pre$Tcorrect,
fit_aci_id121_pre$fitTPU)
colnames(aci_data_id121_pre_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
'aci_km', 'aci_gammastar', 'aci_fitmethod',
'aci_tcorrect', 'aci_fittpu')
curve_fits <- rbind(curve_fits, aci_data_id121_pre_data)
### plant id121 post_heatwave
aci_data_id121_post = subset(aci_data, id == ids[14] & meas.type == 'post_heatwave')
aci_data_id121_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id121_post)
ids[15]
##############################################################################
##############################################################################
###########id122
##############################################################################
##############################################################################
### plant id122 pre_heatwave
aci_data_id122_pre = subset(aci_data, id == ids[15] & meas.type == 'pre_heatwave')
aci_data_id122_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id122_pre)
#### fit aci curve
fit_aci_id122_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
citransition = 350,
Tcorrect = FALSE,
data = aci_data_id122_pre)
summary(fit_aci_id122_pre)
#### plot
plot(fit_aci_id122_pre)
#### fit aci curve
fit_aci_id122_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
citransition = 400,
Tcorrect = FALSE,
data = aci_data_id122_pre)
summary(fit_aci_id122_pre)
#### plot
plot(fit_aci_id122_pre)
#### add to dataframe
aci_data_id122_pre_data <- cbind(aci_data_id122_pre[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id122_pre[,30]),
mean(aci_data_id122_pre[,118]),
fit_aci_id122_pre[[2]][1,1],
fit_aci_id122_pre[[2]][1,2],
fit_aci_id122_pre[[2]][2,1],
fit_aci_id122_pre[[2]][2,2],
fit_aci_id122_pre[[2]][3,1],
fit_aci_id122_pre[[2]][3,2],
fit_aci_id122_pre$RMSE,
fit_aci_id122_pre$Ci_transition,
fit_aci_id122_pre$citransition,
fit_aci_id122_pre$Km,
fit_aci_id122_pre$GammaStar,
fit_aci_id122_pre$fitmethod,
fit_aci_id122_pre$Tcorrect,
fit_aci_id122_pre$fitTPU)
?fitaci
#### fit aci curve
fit_aci_id122_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
citransition = 400,
Tcorrect = FALSE,
fitTPU = TRUE,
data = aci_data_id122_pre)
summary(fit_aci_id122_pre)
#### plot
plot(fit_aci_id122_pre)
#### fit aci curve
fit_aci_id122_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
citransition = 400,
Tcorrect = FALSE,
fitTPU = TRUE,
data = aci_data_id122_pre)
summary(fit_aci_id122_pre)
?fitaci
#### fit aci curve
fit_aci_id122_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 400,
Tcorrect = FALSE,
fitTPU = TRUE,
data = aci_data_id122_pre)
#### fit aci curve
fit_aci_id122_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 400,
Tcorrect = FALSE,
fitTPU = TRUE,
data = aci_data_id122_pre)
#### fit aci curve
fit_aci_id122_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 400,
Tcorrect = FALSE,
# fitTPU = TRUE,
data = aci_data_id122_pre)
summary(fit_aci_id122_pre)
#### plot
plot(fit_aci_id122_pre)
#### fit aci curve
fit_aci_id122_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 400,
Tcorrect = FALSE,
# fitTPU = TRUE,
fitmethod = 'bilinear',
data = aci_data_id122_pre)
summary(fit_aci_id122_pre)
#### fit aci curve
fit_aci_id122_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 400,
Tcorrect = FALSE,
fitTPU = TRUE,
fitmethod = 'bilinear',
data = aci_data_id122_pre)
summary(fit_aci_id122_pre)
#### plot
plot(fit_aci_id122_pre)
#### fit aci curve
fit_aci_id1_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
citransition = 300,
Tcorrect = FALSE,,
fitTPU = TRUE,
fitmethod = 'bilinear',
data = aci_data_id1_pre)
summary(fit_aci_id1_pre)
#### fit aci curve
fit_aci_id1_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
citransition = 300,
Tcorrect = FALSE,
fitTPU = TRUE,
fitmethod = 'bilinear',
data = aci_data_id1_pre)
summary(fit_aci_id1_pre)
coef_id1_pre <- coef(fit_aci_id1_pre)
#### plot
plot(fit_aci_id1_pre)
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id1_post)
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id102_pre)
#### fit aci curve
fit_aci_id102_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
citransition = 350,
Tcorrect = FALSE,
fitTPU = TRUE,
fitmethod = 'bilinear',
data = aci_data_id102_pre)
summary(fit_aci_id102_pre)
#### fit aci curve
fit_aci_id1_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 300,
Tcorrect = FALSE,
fitTPU = TRUE,
fitmethod = 'bilinear',
data = aci_data_id1_pre)
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id1_pre)
summary(fit_aci_id1_pre)
coef_id1_pre <- coef(fit_aci_id1_pre)
#### plot
plot(fit_aci_id1_pre)
summary(fit_aci_id1_pre)
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id11_post)
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id110_pre)
fit_aci_id122_post[[2]]
fit_aci_id1_pre[[2]]
#### plot
plot(fit_aci_id1_pre)
## load packages
library(plantecophys)
install.packages('plantecophys')
## load packages
library(plantecophys)
## load data
aci_data <- read.csv('Dinah_potato_curves_fullyMerged.csv')
head(aci_data)
colnames(aci_data)
## start visualization, curve fitting, and data frame creation
ids <- levels(as.factor(aci_data$id))
curve_fits <- c()
### plant id1 pre_heatwave
aci_data_id1_pre = subset(aci_data, id == ids[1] & meas.type == 'pre_heatwave')
aci_data_id1_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id1_pre)
#### fit aci curve
fit_aci_id1_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 300,
Tcorrect = FALSE,
fitTPU = TRUE,
fitmethod = 'bilinear',
data = aci_data_id1_pre)
summary(fit_aci_id1_pre)
coef_id1_pre <- coef(fit_aci_id1_pre)
#### plot
plot(fit_aci_id1_pre)
#### add to dataframe
aci_data_id1_pre_data <- cbind(aci_data_id1_pre[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id1_pre[,30]),
mean(aci_data_id1_pre[,118]),
fit_aci_id1_pre[[2]][1,1],
fit_aci_id1_pre[[2]][1,2],
fit_aci_id1_pre[[2]][2,1],
fit_aci_id1_pre[[2]][2,2],
fit_aci_id1_pre[[2]][3,1],
fit_aci_id1_pre[[2]][3,2],
fit_aci_id1_pre[[2]][4,1],
fit_aci_id1_pre[[2]][4,2],
fit_aci_id1_pre$RMSE,
fit_aci_id1_pre$Ci_transition,
fit_aci_id1_pre$citransition,
fit_aci_id1_pre$Km,
fit_aci_id1_pre$GammaStar,
fit_aci_id1_pre$fitmethod,
fit_aci_id1_pre$Tcorrect,
fit_aci_id1_pre$fitTPU)
colnames(aci_data_id1_pre_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
'aci_km', 'aci_gammastar', 'aci_fitmethod',
'aci_tcorrect', 'aci_fittpu')
curve_fits <- rbind(curve_fits, aci_data_id1_pre_data)
### plant id1 post_heatwave
aci_data_id1_post = subset(aci_data, id == ids[1] & meas.type == 'post_heatwave')
aci_data_id1_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id1_post)
#### fit aci curve
fit_aci_id1_post = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 350,
Tcorrect = FALSE,
fitTPU = TRUE,
fitmethod = 'bilinear',
data = aci_data_id1_post)
ids[16]
##############################################################################
##############################################################################
###########id129
##############################################################################
##############################################################################
### plant id129 pre_heatwave
aci_data_id129_pre = subset(aci_data, id == ids[16] & meas.type == 'pre_heatwave')
aci_data_id129_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id129_pre)
aci_data_id129_pre[, c(6,9:10)]
2090-1996
##############################################################################
##############################################################################
###########id129
##############################################################################
##############################################################################
### plant id129 pre_heatwave
aci_data_id129_pre = subset(aci_data, id == ids[16] & meas.type == 'pre_heatwave')[1, 95]
aci_data_id129_pre[, c(6,9:10)]
##############################################################################
##############################################################################
###########id129
##############################################################################
##############################################################################
### plant id129 pre_heatwave
aci_data_id129_pre = subset(aci_data, id == ids[16] & meas.type == 'pre_heatwave')[c(1;95),]
##############################################################################
##############################################################################
###########id129
##############################################################################
##############################################################################
### plant id129 pre_heatwave
aci_data_id129_pre = subset(aci_data, id == ids[16] & meas.type == 'pre_heatwave')[c(1:95),]
aci_data_id129_pre[, c(6,9:10)]
##############################################################################
##############################################################################
###########id129
##############################################################################
##############################################################################
### plant id129 pre_heatwave
aci_data_id129_pre = subset(aci_data, id == ids[16] & meas.type == 'pre_heatwave')[c(1:96),]
aci_data_id129_pre[, c(6,9:10)]
##############################################################################
##############################################################################
###########id129
##############################################################################
##############################################################################
### plant id129 pre_heatwave
aci_data_id129_pre = subset(aci_data, id == ids[16] & meas.type == 'pre_heatwave')[c(1:95),]
aci_data_id129_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id129_pre)
### plant id129 post_heatwave
aci_data_id129_post = subset(aci_data, id == ids[16] & meas.type == 'post_heatwave')
aci_data_id129_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id129_post)
ids[17]
##############################################################################
##############################################################################
###########id13
##############################################################################
##############################################################################
### plant id13 pre_heatwave
aci_data_id13_pre = subset(aci_data, id == ids[17] & meas.type == 'pre_heatwave')
aci_data_id13_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id13_pre)
### plant id13 post_heatwave
aci_data_id13_post = subset(aci_data, id == ids[17] & meas.type == 'post_heatwave')
aci_data_id13_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id13_post)
ids[18]
##############################################################################
##############################################################################
###########id131
##############################################################################
##############################################################################
### plant id131 pre_heatwave
aci_data_id131_pre = subset(aci_data, id == ids[18] & meas.type == 'pre_heatwave')[c(1:95),]
aci_data_id131_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id131_pre)
### plant id131 post_heatwave
aci_data_id131_post = subset(aci_data, id == ids[18] & meas.type == 'post_heatwave')
aci_data_id131_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id131_post)
ids[19]
##############################################################################
##############################################################################
###########id133
##############################################################################
##############################################################################
### plant id133 pre_heatwave
aci_data_id133_pre = subset(aci_data, id == ids[19] & meas.type == 'pre_heatwave')[c(1:95),]
aci_data_id133_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id133_pre)
### plant id133 post_heatwave
aci_data_id133_post = subset(aci_data, id == ids[19] & meas.type == 'post_heatwave')
aci_data_id133_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id133_post)
ids[20]
##############################################################################
##############################################################################
###########id136
##############################################################################
##############################################################################
### plant id136 pre_heatwave
aci_data_id136_pre = subset(aci_data, id == ids[20] & meas.type == 'pre_heatwave')[c(1:95),]
aci_data_id136_pre[, c(6,9:10)]
##############################################################################
##############################################################################
###########id136
##############################################################################
##############################################################################
### plant id136 pre_heatwave
aci_data_id136_pre = subset(aci_data, id == ids[20] & meas.type == 'pre_heatwave')
aci_data_id136_pre[, c(6,9:10)]
##############################################################################
##############################################################################
###########id136
##############################################################################
##############################################################################
### plant id136 pre_heatwave
aci_data_id136_pre = subset(aci_data, id == ids[20] & meas.type == 'pre_heatwave')
aci_data_id136_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id136_pre)
### plant id136 post_heatwave
aci_data_id136_post = subset(aci_data, id == ids[20] & meas.type == 'post_heatwave')
aci_data_id136_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id136_post)
ids[21]
##############################################################################
##############################################################################
###########id14
##############################################################################
##############################################################################
### plant id14 pre_heatwave
aci_data_id14_pre = subset(aci_data, id == ids[21] & meas.type == 'pre_heatwave')
aci_data_id14_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id14_pre)
### plant id14 post_heatwave
aci_data_id14_post = subset(aci_data, id == ids[21] & meas.type == 'post_heatwave')
aci_data_id14_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id14_post)
## load packages
library(plantecophys)
## load data
aci_data <- read.csv('Dinah_potato_curves_fullyMerged.csv')
head(aci_data)
colnames(aci_data)
## start visualization, curve fitting, and data frame creation
ids <- levels(as.factor(aci_data$id))
curve_fits <- c()
### plant id1 pre_heatwave
aci_data_id1_pre = subset(aci_data, id == ids[1] & meas.type == 'pre_heatwave')
aci_data_id1_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id1_pre)
#### fit aci curve
fit_aci_id1_pre = fitaci(varnames = list(ALEAF = 'Adyn', Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
# citransition = 300,
Tcorrect = FALSE,
fitTPU = TRUE,
fitmethod = 'bilinear',
data = aci_data_id1_pre)
aci_data_id1_pre[1, c(10, 284, 9, 14, 16, 19)]
mean(aci_data_id1_pre[,30])
mean(aci_data_id1_pre[,118])
fit_aci_id1_pre[[2]]
fit_aci_id1_pre[[2]][1,1]
fit_aci_id1_pre[[2]][1,2]
fit_aci_id1_pre$Ci_transition
fit_aci_id1_pre$citransition
#### add to dataframe
aci_data_id1_pre_data <- cbind(aci_data_id1_pre[1, c(10, 284, 9, 14, 16, 19)],
mean(aci_data_id1_pre[,30]),
mean(aci_data_id1_pre[,118]),
fit_aci_id1_pre[[2]][1,1],
fit_aci_id1_pre[[2]][1,2],
fit_aci_id1_pre[[2]][2,1],
fit_aci_id1_pre[[2]][2,2],
fit_aci_id1_pre[[2]][3,1],
fit_aci_id1_pre[[2]][3,2],
fit_aci_id1_pre[[2]][4,1],
fit_aci_id1_pre[[2]][4,2],
fit_aci_id1_pre$RMSE,
fit_aci_id1_pre$Ci_transition,
fit_aci_id1_pre$citransition,
fit_aci_id1_pre$Km,
fit_aci_id1_pre$GammaStar,
fit_aci_id1_pre$fitmethod,
fit_aci_id1_pre$Tcorrect,
fit_aci_id1_pre$fitTPU)
colnames(aci_data_id1_pre_data) <- c('id', 'heatwave_time', 'machine', 'anet_420', 'ci_420', 'gs_420',
'vpd_leaf', 'temperature_leaf', 'vcmax_tleaf', 'vcmax_tleaf_se',
'jmax_tleaf', 'jmax_tleaf_se', 'rd_tleaf', 'rd_tleaf_se',
'aci_RMSE', 'aci_ci_transistion', 'aci_ci_transition_set',
'aci_km', 'aci_gammastar', 'aci_fitmethod',
'aci_tcorrect', 'aci_fittpu')
curve_fits <- rbind(curve_fits, aci_data_id1_pre_data)
### plant id1 post_heatwave
aci_data_id1_post = subset(aci_data, id == ids[1] & meas.type == 'post_heatwave')
aci_data_id1_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id1_post)
#### plot
plot(fit_aci_id1_pre)
### plant id1 post_heatwave
aci_data_id1_post = subset(aci_data, id == ids[1] & meas.type == 'post_heatwave')
aci_data_id1_post[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id1_post)
##############################################################################
##############################################################################
###########id102
##############################################################################
##############################################################################
### plant id102 pre_heatwave
aci_data_id102_pre = subset(aci_data, id == ids[4] & meas.type == 'pre_heatwave')
aci_data_id102_pre[, c(6,9:10)]
#### plot raw data and remove values if needed
plot(Adyn ~ Ci, data = aci_data_id102_pre)
ids
